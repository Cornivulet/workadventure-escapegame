var ue=Object.defineProperty,ce=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var $=(o,e,n)=>e in o?ue(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,J=(o,e)=>{for(var n in e||(e={}))le.call(e,n)&&$(o,n,e[n]);if(H)for(var n of H(e))be.call(e,n)&&$(o,n,e[n]);return o},N=(o,e)=>ce(o,pe(e));class k{constructor(e){this.properties=e!=null?e:[]}get(e){const n=this.properties.filter(r=>r.name===e).map(r=>r.value);if(n.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(n.length!==0)return n[0]}getString(e){return this.getByType(e,"string")}getNumber(e){return this.getByType(e,"number")}getBoolean(e){return this.getByType(e,"boolean")}getByType(e,n){const r=this.get(e);if(r!==void 0){if(typeof r!==n)throw new Error('Expected property "'+e+'" to have type "'+n+'"');return r}}mustGetString(e){return this.mustGetByType(e,"string")}mustGetNumber(e){return this.mustGetByType(e,"number")}mustGetBoolean(e){return this.mustGetByType(e,"boolean")}mustGetByType(e,n){const r=this.get(e);if(r===void 0)throw new Error('Property "'+e+'" is missing');if(typeof r!==n)throw new Error('Expected property "'+e+'" to have type "'+n+'"');return r}getType(e){const n=this.properties.filter(r=>r.name===e).map(r=>r.type);if(n.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(n.length!==0)return n[0]}}const B="https://unpkg.com/@workadventure/scripting-api-extra@1.3.2/dist";class fe{constructor(e){this.name=e.name,this.x=e.x,this.y=e.y,this.properties=new k(e.properties)}get isReadable(){const e=this.properties.getString("readableBy");return e?WA.player.tags.includes(e):!0}get isWritable(){const e=this.properties.getString("writableBy");return e?WA.player.tags.includes(e):!0}}function K(o){const e=o?"#"+o.join():"";WA.nav.openCoWebSite(B+"/configuration.html"+e)}async function ye(o,e){const n=await WA.room.getTiledMap(),r=new Map;return ne(n.layers,r,o,e),r}function ne(o,e,n,r){for(const t of o)if(t.type==="objectgroup"){for(const s of t.objects)if(s.type==="variable"){if(!!n&&t.name!==n||!!r&&!r.includes(s.name))continue;e.set(s.name,new fe(s))}}else t.type==="group"&&ne(t.layers,e,n,r)}let R;async function D(){return R===void 0&&(R=me()),R}async function me(){return de(await WA.room.getTiledMap())}function de(o){const e=new Map;return re(o.layers,"",e),e}function re(o,e,n){for(const r of o)r.type==="group"?re(r.layers,e+r.name+"/",n):(r.name=e+r.name,n.set(r.name,r))}function he(o){let e=1/0,n=1/0,r=0,t=0;const s=o.data;if(typeof s=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let a=0;a<o.height;a++)for(let u=0;u<o.width;u++)s[u+a*o.width]!==0&&(e=Math.min(e,u),t=Math.max(t,u),n=Math.min(n,a),r=Math.max(r,a));return{top:n,left:e,right:t+1,bottom:r+1}}function te(o){let e=1/0,n=1/0,r=0,t=0;for(const s of o){const a=he(s);a.left<e&&(e=a.left),a.top<n&&(n=a.top),a.right>t&&(t=a.right),a.bottom>r&&(r=a.bottom)}return{top:n,left:e,right:t,bottom:r}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var ge=Object.prototype.toString,x=Array.isArray||function(e){return ge.call(e)==="[object Array]"};function U(o){return typeof o=="function"}function Ae(o){return x(o)?"array":typeof o}function G(o){return o.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Q(o,e){return o!=null&&typeof o=="object"&&e in o}function We(o,e){return o!=null&&typeof o!="object"&&o.hasOwnProperty&&o.hasOwnProperty(e)}var Le=RegExp.prototype.test;function ve(o,e){return Le.call(o,e)}var Me=/\S/;function Pe(o){return!ve(Me,o)}var Ee={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function we(o){return String(o).replace(/[&<>"'`=\/]/g,function(n){return Ee[n]})}var _e=/\s*/,Fe=/\s+/,X=/\s*=/,Se=/\s*\}/,xe=/#|\^|\/|>|\{|&|=|!/;function Ce(o,e){if(!o)return[];var n=!1,r=[],t=[],s=[],a=!1,u=!1,i="",b=0;function m(){if(a&&!u)for(;s.length;)delete t[s.pop()];else s=[];a=!1,u=!1}var A,v,y;function _(w){if(typeof w=="string"&&(w=w.split(Fe,2)),!x(w)||w.length!==2)throw new Error("Invalid tags: "+w);A=new RegExp(G(w[0])+"\\s*"),v=new RegExp("\\s*"+G(w[1])),y=new RegExp("\\s*"+G("}"+w[1]))}_(e||M.tags);for(var l=new T(o),f,h,E,C,Z,F;!l.eos();){if(f=l.pos,E=l.scanUntil(A),E)for(var I=0,ie=E.length;I<ie;++I)C=E.charAt(I),Pe(C)?(s.push(t.length),i+=C):(u=!0,n=!0,i+=" "),t.push(["text",C,f,f+1]),f+=1,C===`
`&&(m(),i="",b=0,n=!1);if(!l.scan(A))break;if(a=!0,h=l.scan(xe)||"name",l.scan(_e),h==="="?(E=l.scanUntil(X),l.scan(X),l.scanUntil(v)):h==="{"?(E=l.scanUntil(y),l.scan(Se),l.scanUntil(v),h="&"):E=l.scanUntil(v),!l.scan(v))throw new Error("Unclosed tag at "+l.pos);if(h==">"?Z=[h,E,f,l.pos,i,b,n]:Z=[h,E,f,l.pos],b++,t.push(Z),h==="#"||h==="^")r.push(Z);else if(h==="/"){if(F=r.pop(),!F)throw new Error('Unopened section "'+E+'" at '+f);if(F[1]!==E)throw new Error('Unclosed section "'+F[1]+'" at '+f)}else h==="name"||h==="{"||h==="&"?u=!0:h==="="&&_(E)}if(m(),F=r.pop(),F)throw new Error('Unclosed section "'+F[1]+'" at '+l.pos);return ze(ke(t))}function ke(o){for(var e=[],n,r,t=0,s=o.length;t<s;++t)n=o[t],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(e.push(n),r=n));return e}function ze(o){for(var e=[],n=e,r=[],t,s,a=0,u=o.length;a<u;++a)switch(t=o[a],t[0]){case"#":case"^":n.push(t),r.push(t),n=t[4]=[];break;case"/":s=r.pop(),s[5]=t[2],n=r.length>0?r[r.length-1][4]:e;break;default:n.push(t)}return e}function T(o){this.string=o,this.tail=o,this.pos=0}T.prototype.eos=function(){return this.tail===""};T.prototype.scan=function(e){var n=this.tail.match(e);if(!n||n.index!==0)return"";var r=n[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r};T.prototype.scanUntil=function(e){var n=this.tail.search(e),r;switch(n){case-1:r=this.tail,this.tail="";break;case 0:r="";break;default:r=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=r.length,r};function S(o,e){this.view=o,this.cache={".":this.view},this.parent=e}S.prototype.push=function(e){return new S(e,this)};S.prototype.lookup=function(e){var n=this.cache,r;if(n.hasOwnProperty(e))r=n[e];else{for(var t=this,s,a,u,i=!1;t;){if(e.indexOf(".")>0)for(s=t.view,a=e.split("."),u=0;s!=null&&u<a.length;)u===a.length-1&&(i=Q(s,a[u])||We(s,a[u])),s=s[a[u++]];else s=t.view[e],i=Q(t.view,e);if(i){r=s;break}t=t.parent}n[e]=r}return U(r)&&(r=r.call(this.view)),r};function L(){this.templateCache={_cache:{},set:function(e,n){this._cache[e]=n},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}L.prototype.clearCache=function(){typeof this.templateCache!="undefined"&&this.templateCache.clear()};L.prototype.parse=function(e,n){var r=this.templateCache,t=e+":"+(n||M.tags).join(":"),s=typeof r!="undefined",a=s?r.get(t):void 0;return a==null&&(a=Ce(e,n),s&&r.set(t,a)),a};L.prototype.render=function(e,n,r,t){var s=this.getConfigTags(t),a=this.parse(e,s),u=n instanceof S?n:new S(n,void 0);return this.renderTokens(a,u,r,e,t)};L.prototype.renderTokens=function(e,n,r,t,s){for(var a="",u,i,b,m=0,A=e.length;m<A;++m)b=void 0,u=e[m],i=u[0],i==="#"?b=this.renderSection(u,n,r,t,s):i==="^"?b=this.renderInverted(u,n,r,t,s):i===">"?b=this.renderPartial(u,n,r,s):i==="&"?b=this.unescapedValue(u,n):i==="name"?b=this.escapedValue(u,n,s):i==="text"&&(b=this.rawValue(u)),b!==void 0&&(a+=b);return a};L.prototype.renderSection=function(e,n,r,t,s){var a=this,u="",i=n.lookup(e[1]);function b(v){return a.render(v,n,r,s)}if(!!i){if(x(i))for(var m=0,A=i.length;m<A;++m)u+=this.renderTokens(e[4],n.push(i[m]),r,t,s);else if(typeof i=="object"||typeof i=="string"||typeof i=="number")u+=this.renderTokens(e[4],n.push(i),r,t,s);else if(U(i)){if(typeof t!="string")throw new Error("Cannot use higher-order sections without the original template");i=i.call(n.view,t.slice(e[3],e[5]),b),i!=null&&(u+=i)}else u+=this.renderTokens(e[4],n,r,t,s);return u}};L.prototype.renderInverted=function(e,n,r,t,s){var a=n.lookup(e[1]);if(!a||x(a)&&a.length===0)return this.renderTokens(e[4],n,r,t,s)};L.prototype.indentPartial=function(e,n,r){for(var t=n.replace(/[^ \t]/g,""),s=e.split(`
`),a=0;a<s.length;a++)s[a].length&&(a>0||!r)&&(s[a]=t+s[a]);return s.join(`
`)};L.prototype.renderPartial=function(e,n,r,t){if(!!r){var s=this.getConfigTags(t),a=U(r)?r(e[1]):r[e[1]];if(a!=null){var u=e[6],i=e[5],b=e[4],m=a;i==0&&b&&(m=this.indentPartial(a,b,u));var A=this.parse(m,s);return this.renderTokens(A,n,r,m,t)}}};L.prototype.unescapedValue=function(e,n){var r=n.lookup(e[1]);if(r!=null)return r};L.prototype.escapedValue=function(e,n,r){var t=this.getConfigEscape(r)||M.escape,s=n.lookup(e[1]);if(s!=null)return typeof s=="number"&&t===M.escape?String(s):t(s)};L.prototype.rawValue=function(e){return e[1]};L.prototype.getConfigTags=function(e){return x(e)?e:e&&typeof e=="object"?e.tags:void 0};L.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!x(e))return e.escape};var M={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(o){z.templateCache=o},get templateCache(){return z.templateCache}},z=new L;M.clearCache=function(){return z.clearCache()};M.parse=function(e,n){return z.parse(e,n)};M.render=function(e,n,r,t){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Ae(e)+'" was given as the first argument for mustache#render(template, view, partials)');return z.render(e,n,r,t)};M.escape=we;M.Scanner=T;M.Context=S;M.Writer=L;class Te{constructor(e,n){this.template=e,this.state=n,this.ast=M.parse(e)}getValue(){return this.value===void 0&&(this.value=M.render(this.template,this.state)),this.value}onChange(e){const n=[];for(const r of this.getUsedVariables().values())n.push(this.state.onVariableChange(r).subscribe(()=>{const t=M.render(this.template,this.state);t!==this.value&&(this.value=t,e(this.value))}));return{unsubscribe:()=>{for(const r of n)r.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const e=new Set;return this.recursiveGetUsedVariables(this.ast,e),e}recursiveGetUsedVariables(e,n){for(const r of e){const t=r[0],s=r[1],a=r[4];["name","&","#","^"].includes(t)&&n.add(s),a!==void 0&&typeof a!="string"&&this.recursiveGetUsedVariables(a,n)}}}async function Ze(){var o;const e=await D();for(const[n,r]of e.entries()){const t=(o=r.properties)!==null&&o!==void 0?o:[];for(const s of t){if(s.type==="int"||s.type==="bool"||s.type==="object"||typeof s.value!="string")continue;const a=new Te(s.value,WA.state);if(a.isPureString())continue;const u=a.getValue();Y(n,s.name,u),a.onChange(i=>{Y(n,s.name,i)})}}}function Y(o,e,n){WA.room.setProperty(o,e,n),e==="visible"&&(n?WA.room.showLayer(o):WA.room.hideLayer(o))}let V,j=0,q=0;function ee(o){if(WA.state[o.name]){let e=o.properties.mustGetString("openLayer");for(const n of e.split(`
`))WA.room.showLayer(n);e=o.properties.mustGetString("closeLayer");for(const n of e.split(`
`))WA.room.hideLayer(n)}else{let e=o.properties.mustGetString("openLayer");for(const n of e.split(`
`))WA.room.hideLayer(n);e=o.properties.mustGetString("closeLayer");for(const n of e.split(`
`))WA.room.showLayer(n)}}function Be(o){const e=o.properties.getString("openSound"),n=o.properties.getNumber("soundRadius");let r=1;if(n){const t=ae(o.properties.mustGetString("openLayer").split(`
`));if(t>n)return;r=1-t/n}e&&WA.sound.loadSound(e).play({volume:r})}function De(o){const e=o.properties.getString("closeSound"),n=o.properties.getNumber("soundRadius");let r=1;if(n){const t=ae(o.properties.mustGetString("closeLayer").split(`
`));if(t>n)return;r=1-t/n}e&&WA.sound.loadSound(e).play({volume:r})}function se(o){return o.map(e=>V.get(e)).filter(e=>(e==null?void 0:e.type)==="tilelayer")}function ae(o){const e=se(o),n=te(e),r=((n.right-n.left)/2+n.left)*32,t=((n.bottom-n.top)/2+n.top)*32;return Math.sqrt(Math.pow(j-r,2)+Math.pow(q-t,2))}function Ie(o){WA.state.onVariableChange(o.name).subscribe(()=>{WA.state[o.name]?Be(o):De(o),ee(o)}),ee(o)}function Re(o,e,n,r){const t=o.name;let s,a,u=!1;const i=n.getString("tag");let b=!0;i&&!WA.player.tags.includes(i)&&(b=!1);const m=!!i;function A(){var l;s&&s.remove(),s=WA.ui.displayActionMessage({message:(l=n.getString("closeTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to close the door",callback:()=>{WA.state[e.name]=!1,v()}})}function v(){var l;s&&s.remove(),s=WA.ui.displayActionMessage({message:(l=n.getString("openTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to open the door",callback:()=>{WA.state[e.name]=!0,A()}})}function y(l){const f=te(se(e.properties.mustGetString("closeLayer").split(`
`)));a=WA.room.website.create({name:"doorKeypad"+l,url:r+"/keypad.html#"+encodeURIComponent(l),position:{x:f.right*32,y:f.top*32,width:32*3,height:32*4},allowApi:!0})}function _(){a&&(WA.room.website.delete(a.name),a=void 0)}WA.room.onEnterLayer(t).subscribe(()=>{if(u=!0,n.getBoolean("autoOpen")&&b){WA.state[e.name]=!0;return}if(!WA.state[e.name]&&(m&&!b||!m)&&(n.getString("code")||n.getString("codeVariable"))){y(t);return}!b||(WA.state[e.name]?A():v())}),WA.room.onLeaveLayer(t).subscribe(()=>{u=!1,n.getBoolean("autoClose")&&(WA.state[e.name]=!1),s&&s.remove(),_()}),WA.state.onVariableChange(e.name).subscribe(()=>{u&&(!n.getBoolean("autoClose")&&WA.state[e.name]===!0&&A(),a&&WA.state[e.name]===!0&&_(),!n.getBoolean("autoOpen")&&WA.state[e.name]===!1&&v())})}function Ge(o){const e=o.properties.mustGetString("bellSound"),n=o.properties.getNumber("soundRadius");let r=1;if(n){const t=Math.sqrt(Math.pow(o.x-j,2)+Math.pow(o.y-q,2));if(t>n)return;r=1-t/n}WA.sound.loadSound(e).play({volume:r})}function Ve(o){WA.state[o.name]===void 0&&(WA.state[o.name]=0),WA.state.onVariableChange(o.name).subscribe(()=>{WA.state[o.name]&&Ge(o)})}function Ue(o,e,n){let r;const t=e.getString("bellPopup");WA.room.onEnterLayer(n).subscribe(()=>{var s;t?r=WA.ui.openPopup(t,"",[{label:(s=e.getString("bellButtonText"))!==null&&s!==void 0?s:"Ring",callback:()=>{WA.state[o]=WA.state[o]+1}}]):WA.state[o]=WA.state[o]+1}),WA.room.onLeaveLayer(n).subscribe(()=>{r&&(r.close(),r=void 0)})}async function je(o){o=o!=null?o:B;const e=await ye();V=await D();for(const n of e.values())n.properties.get("door")&&Ie(n),n.properties.get("bell")&&Ve(n);for(const n of V.values()){const r=new k(n.properties),t=r.getString("doorVariable");if(t&&n.type==="tilelayer"){const a=e.get(t);if(a===void 0)throw new Error('Cannot find variable "'+t+'" referred in the "doorVariable" property of layer "'+n.name+'"');Re(n,a,r,o)}const s=r.getString("bellVariable");s&&Ue(s,r,n.name)}WA.player.onPlayerMove(n=>{j=n.x,q=n.y})}function qe(o,e){const n=o.getString("bindVariable");if(n){const r=o.get("enterValue"),t=o.get("leaveValue"),s=o.getString("triggerMessage"),a=o.getString("tag");Oe(n,e,r,t,s,a)}}function Oe(o,e,n,r,t,s){s&&!WA.player.tags.includes(s)||(n!==void 0&&WA.room.onEnterLayer(e).subscribe(()=>{t||(WA.state[o]=n)}),r!==void 0&&WA.room.onLeaveLayer(e).subscribe(()=>{WA.state[o]=r}))}async function He(){const o=await D();for(const e of o.values()){const n=new k(e.properties);qe(n,e.name)}}let oe;async function $e(o){const e=await WA.room.getTiledMap();o=o!=null?o:B,oe=await D();const n=e.layers.find(r=>r.name==="configuration");if(n){const t=new k(n.properties).getString("tag");(!t||WA.player.tags.includes(t))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(o+"/configuration.html",!0)});for(const s of oe.values()){const a=new k(s.properties),u=a.getString("openConfig");u&&s.type==="tilelayer"&&Je(u.split(","),s.name,a)}}}function Je(o,e,n){let r;const t=n.getString("openConfigAdminTag");let s=!0;t&&!WA.player.tags.includes(t)&&(s=!1);function a(){var i;r&&r.remove(),r=WA.ui.displayActionMessage({message:(i=n.getString("openConfigTriggerMessage"))!==null&&i!==void 0?i:"Press SPACE or touch here to configure",callback:()=>K(o)})}function u(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(e).subscribe(()=>{const i=n.getString("openConfigTrigger");s&&(i&&i==="onaction"?a():K(o))}),WA.room.onLeaveLayer(e).subscribe(()=>{r&&r.remove(),u()})}const Ne=[{lowerBound:0,uppperBound:.5,config:{width:250,height:390,scale:1}},{lowerBound:.5,uppperBound:.8,config:{width:224,height:350,scale:.9}},{lowerBound:.8,uppperBound:1.25,config:{width:132,height:211,scale:.53}},{lowerBound:1.25,uppperBound:2.28,config:{width:64,height:99,scale:.25}},{lowerBound:1.25,config:{width:39,height:63,scale:.16}}],Ke=[{lowerBound:0,uppperBound:1,config:{width:427,height:270,scale:1}},{lowerBound:1,uppperBound:1.9,config:{width:300,height:188,scale:.7}},{lowerBound:1.9,uppperBound:3.5,config:{width:150,height:94,scale:.35}},{lowerBound:3.5,uppperBound:5,config:{width:93,height:58,scale:.21}},{lowerBound:4,config:{width:75,height:46,scale:.17}}];async function Qe(){var o;const e=WA.player.state.tutorialDone,n=/Mobi|Android/i.test(navigator.userAgent),t=await((o=(await WA.room.getTiledMap()).properties)===null||o===void 0?void 0:o.find(a=>a.name==="tutorial")),s=t&&t.value;if(!e&&s){Xe(n);let a=await WA.player.getPosition(),u;const i=await WA.room.website.get("tutorial"),b=()=>{const _=a.x+i.x+i.width>u.x+u.width,l=a.x+i.x<u.x,f=a.y+i.y+i.height>u.y+u.height,h=a.y+i.y<u.y;_?i.x=-i.width-1.5*16:l&&(i.x=1.5*16),f?i.y=-i.height:h&&(i.y=16)},m=y=>{i.width=y.width,i.height=y.height,i.scale=y.scale},A=y=>{const l=(n?Ne:Ke).filter(f=>{if(f.lowerBound&&f.uppperBound)return f.lowerBound<y&&y<=f.uppperBound;if(f.lowerBound&&!f.uppperBound)return f.lowerBound<y;if(!f.lowerBound&&f.uppperBound)return y<=f.uppperBound;throw new Error(`Zoom level of: ${y} could not fit in any of the desktopConfig's ranges.`)});m(l[0].config)},v=()=>{if(u===void 0)return;const y=u.zoom;A(y),b()};WA.player.onPlayerMove(y=>{a=y,v()}),WA.camera.onCameraUpdate().subscribe(y=>{u=y,v()}),WA.player.state.tutorialDone=!0}}function Xe(o){let e={allow:"",name:"tutorial",url:B+"/tutorial.html",position:{height:224,width:407,x:16,y:-112},visible:!0,allowApi:!0,origin:"player",scale:.9};o&&(e=N(J({},e),{position:{x:32,y:-225,height:390,width:250},scale:1})),WA.room.website.create(e)}function O(){return WA.onInit().then(()=>{je().catch(o=>console.error(o)),He().catch(o=>console.error(o)),$e().catch(o=>console.error(o)),Ze().catch(o=>console.error(o)),Qe().catch(o=>console.error(o))}).catch(o=>console.error(o))}let c;function p(){c!==void 0&&(c.close(),c=void 0)}function Ye(){return WA.onInit().then(()=>{console.log("Scripting for forest"),console.log("Player tags: ",WA.player.tags),WA.room.onEnterLayer("MaisonForet/tutoZone").subscribe(()=>{c=WA.ui.openPopup("tutoForet","Afin de pouvoir vous enfuir, vous devez trouver le code de la barri\xE8re qui m\xE8ne \xE0 la barque. La solution se trouve sur les arbres. Mais seul un arbre contient le bon code. Aidez vous des quatres statues pour trouver le bon arbre. Chaque \xE9nigme de statues donne une lettre du bon arbre.",[])}),WA.room.onEnterLayer("MaisonForet/a1zone").subscribe(()=>{c=WA.ui.openPopup("a1","Fr\xEAne : 5__",[])}),WA.room.onEnterLayer("MaisonForet/a2zone").subscribe(()=>{c=WA.ui.openPopup("a2","Sorbier : ___4",[])}),WA.room.onEnterLayer("MaisonForet/a3zone").subscribe(()=>{c=WA.ui.openPopup("a3","Sapin : 8___",[])}),WA.room.onEnterLayer("MaisonForet/a4zone").subscribe(()=>{c=WA.ui.openPopup("a4","Ch\xEAne : ___7",[])}),WA.room.onEnterLayer("MaisonForet/a5zone").subscribe(()=>{c=WA.ui.openPopup("a5","Pin : 2___",[])}),WA.room.onEnterLayer("MaisonForet/a6zone").subscribe(()=>{c=WA.ui.openPopup("a6","Pin : _8__",[])}),WA.room.onEnterLayer("MaisonForet/a7zone").subscribe(()=>{c=WA.ui.openPopup("a7","\xC9rable : __4_",[])}),WA.room.onEnterLayer("MaisonForet/a8zone").subscribe(()=>{c=WA.ui.openPopup("a8","Fr\xEAne : __3_",[])}),WA.room.onEnterLayer("MaisonForet/a9zone").subscribe(()=>{c=WA.ui.openPopup("a9","Prunier : __8_",[])}),WA.room.onEnterLayer("MaisonForet/a10zone").subscribe(()=>{c=WA.ui.openPopup("a10","Sorbier : 0___",[])}),WA.room.onEnterLayer("MaisonForet/a11zone").subscribe(()=>{c=WA.ui.openPopup("a11","Pin : __6_",[])}),WA.room.onEnterLayer("MaisonForet/a12zone").subscribe(()=>{c=WA.ui.openPopup("a12","\xC9rable : ___1",[])}),WA.room.onEnterLayer("MaisonForet/a13zone").subscribe(()=>{c=WA.ui.openPopup("a13","Prunier : _4__",[])}),WA.room.onEnterLayer("MaisonForet/a14zone").subscribe(()=>{c=WA.ui.openPopup("a14","Ch\xE2taignier : _6__",[])}),WA.room.onEnterLayer("MaisonForet/a15zone").subscribe(()=>{c=WA.ui.openPopup("a15","Sapin : __9_",[])}),WA.room.onEnterLayer("MaisonForet/a16zone").subscribe(()=>{c=WA.ui.openPopup("a16","Sorbier : _7__",[])}),WA.room.onEnterLayer("MaisonForet/a17zone").subscribe(()=>{c=WA.ui.openPopup("a17","Cerisier : _3__",[])}),WA.room.onEnterLayer("MaisonForet/a18zone").subscribe(()=>{c=WA.ui.openPopup("a18","Ch\xEAne : 1___",[])}),WA.room.onEnterLayer("MaisonForet/a19zone").subscribe(()=>{c=WA.ui.openPopup("a19","Cerisier : ___1",[])}),WA.room.onEnterLayer("MaisonForet/a20zone").subscribe(()=>{c=WA.ui.openPopup("a20","Fr\xEAne : ___6",[])}),WA.room.onEnterLayer("MaisonForet/a21zone").subscribe(()=>{c=WA.ui.openPopup("a21","Prunier : 6___",[])}),WA.room.onEnterLayer("MaisonForet/a22zone").subscribe(()=>{c=WA.ui.openPopup("a22","Ch\xE2taignier : 4___",[])}),WA.room.onEnterLayer("MaisonForet/a23zone").subscribe(()=>{c=WA.ui.openPopup("a23","\xC9rable : 3___",[])}),WA.room.onEnterLayer("MaisonForet/a24zone").subscribe(()=>{c=WA.ui.openPopup("a24","Prunier : ___5",[])}),WA.room.onEnterLayer("MaisonForet/a25zone").subscribe(()=>{c=WA.ui.openPopup("a25","Cerisier : 7___",[])}),WA.room.onEnterLayer("MaisonForet/a26zone").subscribe(()=>{c=WA.ui.openPopup("a26","Fr\xEAne : 5__",[])}),WA.room.onEnterLayer("MaisonForet/a27zone").subscribe(()=>{c=WA.ui.openPopup("a27","Pin : ___3",[])}),WA.room.onEnterLayer("MaisonForet/a28zone").subscribe(()=>{c=WA.ui.openPopup("a28","Cerisier : ___1",[])}),WA.room.onEnterLayer("MaisonForet/a29zone").subscribe(()=>{c=WA.ui.openPopup("a29","Ch\xEAne : __5_",[])}),WA.room.onEnterLayer("MaisonForet/a30zone").subscribe(()=>{c=WA.ui.openPopup("a30","Sapin : _1__",[])}),WA.room.onEnterLayer("MaisonForet/a31zone").subscribe(()=>{c=WA.ui.openPopup("a31","Ch\xE2taignier : __7_",[])}),WA.room.onEnterLayer("MaisonForet/a32zone").subscribe(()=>{c=WA.ui.openPopup("a32","Sapin : ___7",[])}),WA.room.onEnterLayer("MaisonForet/a33zone").subscribe(()=>{c=WA.ui.openPopup("a33","\xC9rable : _7__",[])}),WA.room.onEnterLayer("MaisonForet/a34zone").subscribe(()=>{c=WA.ui.openPopup("a34","Ch\xE2taignier : ___8",[])}),WA.room.onEnterLayer("MaisonForet/a35zone").subscribe(()=>{c=WA.ui.openPopup("a35","Sorbier : __1_",[])}),WA.room.onEnterLayer("MaisonForet/a36zone").subscribe(()=>{c=WA.ui.openPopup("a36","Ch\xEAne : _9__",[])}),WA.room.onEnterLayer("MaisonForet/statusForetZone1").subscribe(()=>{c=WA.ui.openPopup("s1","Je suis seul mais en couple, J'enfile mon crochet devant certains, Il en faut deux pour \xEAtre en accord, Je suis cach\xE9 mais on me retrouve deux fois ",[])}),WA.room.onEnterLayer("MaisonForet/statusForetZone2").subscribe(()=>{c=WA.ui.openPopup("s2","Je suis la lettre la plus tranchante",[])}),WA.room.onEnterLayer("MaisonForet/statusForetZone3").subscribe(()=>{c=WA.ui.openPopup("s3","Je suis le commencement de l\u2019effroi, La fin de la dur\xE9e et de l\u2019espace, Le commencement de toutes extr\xE9mit\xE9s",[])}),WA.room.onEnterLayer("MaisonForet/statusForetZone4").subscribe(()=>{c=WA.ui.openPopup("s4","Je suis tout au bout de ta main, je commence la nuit et je finis demain",[])}),WA.room.onLeaveLayer("MaisonForet/tutoZone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a1zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a2zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a3zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a4zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a5zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a6zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a7zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a8zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a9zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a10zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a11zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a12zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a13zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a14zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a15zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a16zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a17zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a18zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a19zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a20zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a21zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a22zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a23zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a24zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a25zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a26zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a27zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a28zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a29zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a30zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a31zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a32zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a33zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a34zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a35zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/a36zone").subscribe(p),WA.room.onLeaveLayer("MaisonForet/statusForetZone1").subscribe(p),WA.room.onLeaveLayer("MaisonForet/statusForetZone2").subscribe(p),WA.room.onLeaveLayer("MaisonForet/statusForetZone3").subscribe(p),WA.room.onLeaveLayer("MaisonForet/statusForetZone4").subscribe(p),O().then(()=>{console.log("Scripting API Extra ready")}).catch(o=>console.error(o))}).catch(o=>console.error(o))}let g;function P(){g!==void 0&&(g.close(),g=void 0)}function eo(){return WA.onInit().then(()=>{console.log("Scripting API ready for room2"),console.log("Player tags: ",WA.player.tags),WA.room.onEnterLayer("MaisonTemps/statusTempsZone1").subscribe(()=>{g=WA.ui.openPopup("status1Room2","Une horloge ajoute 15 minutes de temps. Son heure est la premi\xE8re partie du code",[])}),WA.room.onEnterLayer("MaisonTemps/statusTempsZone2").subscribe(()=>{g=WA.ui.openPopup("status2Room2","Une horloge ajoute 1 heure de temps. Ses minutes sont la seconde partie du code",[])}),WA.room.onEnterLayer("MaisonTemps/clockZone1").subscribe(()=>{const o=new Date;o.setHours(o.getHours()+1);const e=o.getHours()+":43";g=WA.ui.openPopup("clockPopup1","Il est "+e,[])}),WA.room.onEnterLayer("MaisonTemps/clockZone2").subscribe(()=>{const o=new Date;o.setMinutes(o.getMinutes()+15);const e="20:"+o.getMinutes();g=WA.ui.openPopup("clockPopup2","Il est "+e,[])}),WA.room.onEnterLayer("MaisonTemps/clockZone3").subscribe(()=>{const o="25:61";g=WA.ui.openPopup("clockPopup3","Il est "+o,[])}),WA.room.onEnterLayer("MaisonTemps/clockZone4").subscribe(()=>{g=WA.ui.openPopup("clockPopup4","Cette horloge semble cass\xE9",[])}),WA.room.onEnterLayer("MaisonTemps/clockZone5").subscribe(()=>{const o=new Date,e=o.getHours()+":"+o.getMinutes();g=WA.ui.openPopup("clockPopup5","Il est "+e,[])}),WA.room.onEnterLayer("MaisonTemps/clockZone6").subscribe(()=>{const o="AB:CD";g=WA.ui.openPopup("clockPopup6","Il est "+o,[])}),WA.room.onEnterLayer("MaisonTemps/clockZone7").subscribe(()=>{g=WA.ui.openPopup("clockPopup7","Etrange, l'aiguille tourne dans le sens inverse",[])}),WA.room.onEnterLayer("MaisonTemps/clockZone8").subscribe(()=>{const o=new Date,e=o.getHours()+":"+o.getMinutes();g=WA.ui.openPopup("clockPopup8","Il est "+e,[])}),WA.room.onEnterLayer("MaisonTemps/clockZone9").subscribe(()=>{const o=new Date,e=o.getMinutes()+":"+o.getHours();g=WA.ui.openPopup("clockPopup9","Il est "+e,[])}),WA.room.onEnterLayer("MaisonTemps/clockZone10").subscribe(()=>{const o=new Date,e=o.getHours()+":"+o.getMinutes();g=WA.ui.openPopup("clockPopup10","Il est "+e,[])}),WA.room.onEnterLayer("MaisonTemps/clockZone11").subscribe(()=>{const o=new Date,e=o.getHours()+":"+o.getMinutes();g=WA.ui.openPopup("clockPopup11","Il est "+e,[])}),WA.room.onLeaveLayer("MaisonTemps/statusTempsZone1").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/statusTempsZone2").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone1").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone2").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone3").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone4").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone5").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone6").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone7").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone8").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone9").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone10").subscribe(P),WA.room.onLeaveLayer("MaisonTemps/clockZone11").subscribe(P),O().then(()=>{console.log("Scripting API Extra ready")}).catch(o=>console.error(o))}).catch(o=>console.error(o))}let d;function W(){d!==void 0&&(d.close(),d=void 0)}function oo(){return WA.onInit().then(()=>{console.log("Scripting API ready for room1"),console.log("Player tags: ",WA.player.tags),WA.room.onEnterLayer("MaisonDebut/gameStartZone").subscribe(()=>{d=WA.ui.openPopup("gameStartPopup","Vous \xEAtes enferm\xE9 par l'ESGI, pour y echapper allez voir les statues.",[])}),WA.room.onLeaveLayer("MaisonDebut/gameStartZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/statue1Room1Zone").subscribe(()=>{d=WA.ui.openPopup("statue1Popup","\xC9nigme: Pas de pieds, pas de mains, pas d\u2019ailes, mais je monte au ciel. Qui suis-je ? ",[])}),WA.room.onLeaveLayer("MaisonDebut/statue1Room1Zone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/statue2Room1Zone").subscribe(()=>{d=WA.ui.openPopup("statue2Room1Popup","\xC9nigme: Il nous voit vieillir sans rien dire car il est tr\xE8s poli. Qui est-il ? ",[])}),WA.room.onLeaveLayer("MaisonDebut/statue2Room1Zone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/miroirZone").subscribe(()=>{d=WA.ui.openPopup("miroirPopup"," Le miroir est cass\xE9 en quatre, on peut y lire un 6 et un 4",[])}),WA.room.onLeaveLayer("MaisonDebut/miroirZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/chemineeZone").subscribe(()=>{d=WA.ui.openPopup("chemineePopup"," Des papiers ont \xE9t\xE9 br\xFBl\xE9s, il reste une feuille o\xF9 le centre est intact, on peut y lire le chiffre 28.",[])}),WA.room.onLeaveLayer("MaisonDebut/chemineeZone").subscribe(W),WA.room.onEnterLayer("endZone").subscribe(()=>{d=WA.ui.openPopup("endPopup"," F\xE9licitation, vous pouvez maintenant partir rejoindre l'\xEEle des Vacancs !",[])}),WA.room.onLeaveLayer("endZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/fakeCuisineZone").subscribe(()=>{d=WA.ui.openPopup("cuisinePopup","La cuisine vient d'\xEAtre utilis\xE9e, on peut trouver 3 casseroles dans le lavabo.",[])}),WA.room.onLeaveLayer("MaisonDebut/fakeCuisineZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/fakePianoZone").subscribe(()=>{d=WA.ui.openPopup("pianoPopup","Le piano est en mauvaise \xE9tat, il manque 1 p\xE9dale et 5 touches.",[])}),WA.room.onLeaveLayer("MaisonDebut/fakePianoZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/fakeArmoireZone").subscribe(()=>{d=WA.ui.openPopup("armoirePopup","Il y a 7 manteaux dans l'armoire, et 2 paires de chaussures.",[])}),WA.room.onLeaveLayer("MaisonDebut/fakeArmoireZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/fakeBiblioZone").subscribe(()=>{d=WA.ui.openPopup("biblioPopup","On peut trouver 3 livres sur Javascript et 4 sur C#.",[])}),WA.room.onLeaveLayer("MaisonDebut/fakeBiblioZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/fakeNourritureZone").subscribe(()=>{d=WA.ui.openPopup("nourriturePopup","Les aliments n'ont pas l'air d'\xEAtre frais, il y a tonneau sans aliments.",[])}),WA.room.onLeaveLayer("MaisonDebut/fakeNourritureZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/room1horlogeZone").subscribe(()=>{d=WA.ui.openPopup("room1horlogePopup","Les pendules ne bougent pas, elles sont arr\xEAt\xE9es \xE0 08:19.",[])}),WA.room.onLeaveLayer("MaisonDebut/room1horlogeZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/fakeLitZone").subscribe(()=>{d=WA.ui.openPopup("litPopup","Seul le lit du milieu n'a pas de drap.",[])}),WA.room.onLeaveLayer("MaisonDebut/fakeLitZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/fakeLitDoubleZone").subscribe(()=>{d=WA.ui.openPopup("litDoublePopup","Le lit double \xE0 l'air d'\xEAtre tremp\xE9.",[])}),WA.room.onLeaveLayer("MaisonDebut/fakeLitDoubleZone").subscribe(W),WA.room.onEnterLayer("MaisonDebut/fakeTableZone").subscribe(()=>{d=WA.ui.openPopup("tablePopup","Les plats sont encore chaud, il y a 4 couverts mais que 3 assiettes.",[])}),WA.room.onLeaveLayer("MaisonDebut/fakeTableZone").subscribe(W),O().then(()=>{console.log("Scripting API Extra ready")}).catch(o=>console.error(o))}).catch(o=>console.error(o))}console.log("Script started successfully");oo();Ye();eo();
